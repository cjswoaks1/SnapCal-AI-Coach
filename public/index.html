<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SnapCal - AI 자동 칼로리 계산기</title>
  <!-- 고급스러운 폰트 적용 (Space Grotesk, Pretendard) -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" as="style" crossorigin
    href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/variable/pretendardvariable.css" />
  <link rel="stylesheet" href="style.css?v=3">
  <!-- Chart.js 연동 (Phase 2) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Custom JS (Cache busting) -->
  <script type="module" src="app.js?v=7"></script>
</head>

<body>
  <div id="app-container">
    <!-- 네비게이션 및 헤더 -->
    <header>
      <div class="logo">SnapCal <span>AI</span></div>
      <div id="auth-section">
        <button id="login-btn" class="nav-btn">로그인</button>
        <div id="user-profile" class="hidden">
          <span id="user-name"></span>
          <button id="logout-btn" class="nav-btn outline">로그아웃</button>
        </div>
      </div>
    </header>

    <!-- 탭 네비게이션 -->
    <nav class="tabs">
      <button class="tab-btn active" data-target="scanner-view">AI 스캐너</button>
      <button class="tab-btn" data-target="history-view">식단 기록 (월간)</button>
      <button class="tab-btn" data-target="profile-view">내 프로필</button>
    </nav>

    <main>
      <!-- 1. AI 스캐너 뷰 -->
      <section id="scanner-view" class="view-section active">
        <div class="camera-container">
          <div class="camera-frame">
            <!-- 데모용 카메라 뷰 (이미지 업로드로 대체) -->
            <div id="camera-overlay">
              <p>오늘의 식단을 촬영하거나 업로드하세요</p>
              <input type="file" id="food-image-input" accept="image/*" hidden>
              <label for="food-image-input" class="upload-btn">📸 사진 선택 / 촬영</label>
            </div>
            <img id="food-preview" src="" alt="음식 사진 미리보기" class="hidden">

            <!-- AI 인식 마커 (UI 연출용) -->
            <div id="ai-markers" class="hidden">
              <div class="marker" style="top:50%; left:20%;">톳나물무침 (45kcal)</div>
              <div class="marker" style="top:60%; left:60%;">구운 김 (20kcal)</div>
            </div>
          </div>
        </div>

        <div class="action-area">
          <button id="analyze-btn" class="primary-btn" disabled>AI 분석 시작하기</button>
        </div>

        <!-- 분석 결과 카드 -->
        <div id="result-card" class="glass-card hidden">
          <h3>오늘의 한 끼 분석 완료 ✨</h3>
          <div class="total-calories">
            <span id="calc-calories">0</span> kcal
          </div>

          <div class="macro-bars">
            <!-- 기존 매크로 바 유지 ... -->
            <div class="macro-item">
              <div class="macro-header">
                <span>Protein (단백질)</span>
                <span id="val-protein">0g</span>
              </div>
              <div class="progress-bar">
                <div class="fill protein-fill" style="width: 0%;"></div>
              </div>
            </div>
            <div class="macro-item">
              <div class="macro-header">
                <span>Carbs (탄수화물)</span>
                <span id="val-carbs">0g</span>
              </div>
              <div class="progress-bar">
                <div class="fill carbs-fill" style="width: 0%;"></div>
              </div>
            </div>
            <div class="macro-item">
              <div class="macro-header">
                <span>Fat (지방)</span>
                <span id="val-fat">0g</span>
              </div>
              <div class="progress-bar">
                <div class="fill fat-fill" style="width: 0%;"></div>
              </div>
            </div>
          </div>

          <!-- 🔥 안티그래비티(NotebookLM 연동) AI 코칭 영역 추가 -->
          <div id="ai-coaching-box" class="coaching-box hidden">
            <h4>🧠 SnapCal AI 영양 코치</h4>
            <p id="ai-coaching-message">분석 중입니다...</p>
          </div>

          <button id="save-meal-btn" class="secondary-btn">이 식단 기록에 저장하기</button>
        </div>

        <!-- 프리미엄 구독 배너 (수익 모델) -->
        <div class="premium-banner">
          <div class="banner-content">
            <h4>Unlock Premium Reports 👑</h4>
            <p>맞춤형 다이어트 코칭과 완벽한 식단 리포트를 받아보세요.</p>
          </div>
          <button class="upgrade-btn">Go Premium</button>
        </div>
      </section>

      <!-- 2. 월간 식단 기록 뷰 (대표님 아이디어) -->
      <section id="history-view" class="view-section hidden">
        <div class="history-header">
          <h2>이번 달 누적 섭취량</h2>
          <p>매일 기록하고 눈으로 변화를 확인하세요.</p>
        </div>

        <div class="monthly-summary glass-card">
          <div class="summary-circle">
            <span id="monthly-total-calories">0</span>
            <span class="unit">kcal</span>
          </div>
          <div class="summary-details">
            <p>이번 달 총 <strong><span id="meal-count">0</span></strong>끼의 식단을 기록했습니다.</p>
            <p id="calorie-status-msg" style="font-size:0.85rem; color: var(--text-secondary); margin-top:5px;"></p>
          </div>
        </div>

        <!-- 📊 Phase 2: 시각화 대시보드 차트 영역 -->
        <div class="dashboard-grid">
          <div class="chart-card glass-card">
            <h3>매크로(탄/단/지) 비율</h3>
            <div class="canvas-container">
              <canvas id="macro-donut-chart"></canvas>
            </div>
          </div>
          <div class="chart-card glass-card">
            <h3>일자별 칼로리 섭취량</h3>
            <div class="canvas-container">
              <canvas id="daily-bar-chart"></canvas>
            </div>
          </div>
        </div>

        <div class="daily-list-container">
          <h3>최근 기록된 식단</h3>
          <ul id="meal-history-list" class="meal-list">
            <!-- JS로 데이터 삽입됨 -->
            <p class="empty-state">아직 기록된 식단이 없습니다. 스캐너에서 사진을 찍어 기록을 남겨보세요!</p>
          </ul>
        </div>
      </section>
      <!-- 3. 초개인화 프로필 뷰 (Phase 1) -->
      <section id="profile-view" class="view-section hidden">
        <div class="history-header">
          <h2>나만의 전담 영양사</h2>
          <p>정확한 신체 정보를 알려주시면 더 날카로운 코칭을 제공합니다.</p>
        </div>

        <div class="profile-form glass-card">
          <div class="form-group">
            <label for="prof-gender">성별</label>
            <select id="prof-gender">
              <option value="male">남성</option>
              <option value="female">여성</option>
            </select>
          </div>
          <div class="form-group">
            <label for="prof-age">나이</label>
            <input type="number" id="prof-age" placeholder="예: 30" min="10" max="100">
            <span class="unit-span">세</span>
          </div>
          <div class="form-group">
            <label for="prof-height">키</label>
            <input type="number" id="prof-height" placeholder="예: 175" min="100" max="250">
            <span class="unit-span">cm</span>
          </div>
          <div class="form-group">
            <label for="prof-weight">현재 체중</label>
            <input type="number" id="prof-weight" placeholder="예: 70" min="30" max="250">
            <span class="unit-span">kg</span>
          </div>
          <div class="form-group">
            <label for="prof-target-weight">목표 체중</label>
            <input type="number" id="prof-target-weight" placeholder="예: 65" min="30" max="250">
            <span class="unit-span">kg</span>
          </div>
          <div class="form-group">
            <label for="prof-goal">다이어트 목표</label>
            <select id="prof-goal">
              <option value="loss">체중 감량 (다이어트)</option>
              <option value="maintenance">체중 유지</option>
              <option value="gain">근육 증량 (벌크업)</option>
            </select>
          </div>

          <button id="save-profile-btn" class="primary-btn" style="width: 100%; margin-top: 15px;">정보 저장하기</button>
          <p id="profile-msg" style="text-align: center; margin-top: 10px; font-size: 0.9rem; color: var(--accent);">
          </p>
        </div>
      </section>
    </main>
  </div>
</body>

</html>